
Neural ensemble communities: Open-source approaches to hardware for large-scale recording

Joshua H. Siegle1,2, Gregory J. Hale2, Jonathan P. Newman2, Jakob Voigts2

1Present address: Allen Institute for Brain Science, Seattle, WA
2Department of Brain and Cognitive Sciences, MIT, Cambridge, MA


correspondence: Josh Siegle, joshs@alleninstitute.org


Abstract

One often overlooked factor when selecting a platform for recording from many extracellular electrodes simultaneously is whether or not a particular data acquisition system is open or closed: that is, whether or not the schematics and source code are available to end users. Open systems have a reputation for being difficult to acquire, poorly documented, and hard to maintain. With the arrival of more powerful and compact integrated circuits, rapid prototyping services, and web-based tools for collaborative development, these stereotypes must be reconsidered. We discuss some of the reasons why large-scale electrophysiology could benefit from open-source approaches and describe examples of successful community-driven tool development within this field. Rather than championing the use of open-source hardware across the board, we advocate a move toward standardized, open interfaces that connect each element of the data processing pipeline. This will give researchers the flexibility to modify their tools when necessary, while allowing them to continue to benefit from the high-quality products and expertise provided by commercial vendors.

Introduction

Major breakthroughs in neuroscience often occur shortly after new methods become available. Many investigators prioritize in-house tool building, since being the first to apply cutting-edge technologies frequently leads to high-impact publications. How does the hardware developed within individual laboratories make its way to the wider community? Companies invest the time and money required to create polished commodities, which they then distribute back to researchers. These products typically contain proprietary schematics and source code, which prevents modification by users and commercial competitors. Important elements of the hardware, which must be understood in order to replicate it or adapt it, become “closed” to end users.

In most cases, the benefits of having companies supply robust, well-documented devices outweigh the costs of dealing with closed hardware. Most scientists are happy to pay for commercial tools, especially if they generate useful data and are widely adopted by their peers. In some instances, though, relying on closed-source tools can hinder progress. When commercial hardware is treated as a “black box,” it can limit scientists’ understanding of the data being generated, as well as their ability to alter its functionality in light of new experimental demands. Furthermore, tools from different companies—even those designed for the same function—are often incompatible with one another. Once a system is chosen, future work may end up locked in to a particular data processing pipeline.

Recent advances in the domain of open-source design have increased the quality of tools built by scientists, extending their usefulness beyond their lab of origin. When designed properly, open-source hardware can combine the user-friendliness and dependability of commercial products with the high performance and flexibility of tools developed in-house. There are numerous examples of open-source software making an impact in neuroscience1-9, but open-source hardware has yet to take hold in the same way. We expect that to change in the near future.

In this opinion piece, we outline the merits of open-source development schemes with respect to a widely used neuroscientific technique: high-channel-count electrophysiology. We argue that the vanishing differences in product quality between open and closed no longer justify the increased cost, hardware lock-in, and lack of interoperability of commercial options. Standardizing the interfaces within the electrophysiologist’s toolchain can lead to a scenario in which open and closed systems can flourish side by side. Giving more resources to open-source initiatives in electrophysiology will lead to considerable productivity benefits for scientists—even those without an inclination toward engineering.


Electrophysiology is well-suited for an open development model

In the simplest case, recording electrical signals from the brain only requires two conductors to measure a potential difference, a means of amplifying that difference, and a method to store changes in this signal over time. A century ago, nerve impulses were being amplified using vacuum tubes and recorded on photographic film scanned behind a mercury column10. Today, mass-produced circuits costing a few dollars can be used to amplify neural signals and store them digitally. In recent years, there has been a push to record from dozens or hundreds of channels simultaneously in order to understand the brain at the network level11-14. Simultaneously, experimental designs now call for equipment that can precisely manipulate neural activity in real time, as well as record it15-21.

For the most part, these advances in recording and stimulation technology have occurred within individual labs and were then commercialized and distributed. The resulting systems are typically monolithic and closed. Some of the major vendors of commercial electrophysiology data acquisition systems are Neuralynx, Plexon, Blackrock, Tucker-Davis Technologies, Ripple, and Axona. By giving researchers access to high-quality, professionally tested tools, as well as reliable support services, these companies have been essential to the proliferation of multichannel electrophysiology systems over the past two decades. However, it is no longer clear that these services should be provided exclusively by commercial entities.

We see three reasons why the current model of tool development and distribution would benefit from an active open-source community:

1. Electrode technology is advancing rapidly. Experimenters using twisted-wire tetrodes are packing more electrodes into a smaller area10,22, silicon probes are becoming thinner and denser23-25, and dynamically reconfigurable probes are under development26. Researchers need the flexibility to choose among these options, or to mix technologies. Companies that implement proprietary standards often prevent this. One recent example of this is the development of amplifier chips by Intan technologies, which can amplify and digitize up to 64 channels of neural data in an 8 x 8 mm package (http://www.intantech.com)27,28. When integrated into a "headstage" (the interface that connects electrodes to a data acquisition system), Intan chips offer considerable advantages over analog systems. For this reason, nearly every major vendor now sells headstages that use Intan chips, but none of them are interchangeable. Users are stuck with whatever connectors the vendors have chosen to provide, and cannot customize them without the help of the manufacturer.

2. On the software side, the requirements for analysis and visualization vary greatly between labs, and even between experiments. Specialized algorithms are needed to handle electrophysiological data, especially when closed-loop feedback is required. It is often impossible to predict which algorithms will work best before the experiments have been run. An example of this is online spike-sorting, which allows researchers to analyze the activity of single neurons during an experiment29-31. A few commercial systems already implement this method, but use different algorithms that may not be fully disclosed. This makes it difficult or impossible to compare data collected across different labs32,33.

3. Electrophysiologists tend to be technically savvy and favor a "do it yourself" approach to science. Some of this is cultural, but much of it is out of necessity. The complexity of neural systems has forced many electrophysiologists to develop customized hardware and software for their experiments. Unfortunately, very little of this development is currently shared, leading to a huge amount of redundant effort within and across laboratories.

These reasons, which are not unique to extracellular electrophysiology, make it likely that a shift toward a more open development model will occur in the near future.

A brief history of open-source approaches to multichannel data acquisition

Since the widespread adoption of multichannel recording techniques, there have been several attempts to develop open-source recording platforms that are polished enough and sufficiently well-documented to propagate beyond the labs that invented them. This is not meant to be an exhaustive list of such platforms; rather, we hope to provide examples of how shifts in technology created opportunities for scientists to improve on previously available systems. Figure 1 charts the changes that have occurred in the price and channel count of these systems over time.

A/D

One of the first advances that drove the need for high-channel-count extracellular electrophysiology was the introduction of tetrode recording technology34,35. By placing four tightly spaced electrodes at a single location in the brain, tetrodes increased the number of identified neurons that could be isolated. Tetrodes were essential for understanding of how the hippocampus represents the environment 36,37, but also increased the number of simultaneously recorded channels required in any given experiment. In Bruce McNaughton’s lab at the University of Arizona, and later in his own lab at MIT, Matt Wilson (along with his graduate student, Loren Frank) designed and built the “A/D,” an open-source system capable of processing data from many tetrodes in parallel. The closed-source alternative, DataWave, lacked the flexibility required for tetrode recordings, and Dr. Wilson didn’t want his research to be tied to the destiny of a single company. Although the designs for A/D were open, they were shared by invitation only, since there was no way to easily monitor the quality of modifications to the source code, as there is today.

MEABench

Another domain that demands high channel counts is recording action potentials from cell cultures using planar microelectrode arrays (MEAs). In 2005, Daniel Wagenaar, Tom Demarse, and Steve Potter created MEABench, a set of Linux (https://www.kernel.org/) command-line programs for acquiring, processing, and saving voltages from these arrays. Each MEABench program applies a function, such as “Filter” or “Record,” to a multichannel data stream. A standardized interface allows programs to be daisy-chained and branched in order to construct complex signal processing arrangements. Although MEABench does not provide native support for closed-loop experiments, it can  becombined with real-time simulation tools38 to create feedback loops39. MEABench has limited hardware driver support and currently only works with outdated and expensive Multichannel Systems data acquisition cards. However, the modularity and reconfigurability of MEABench have inspired more modern open-source solutions.

NeuroRighter

In the mid-2000s, the introduction of high-channel-count analog-to-digital conversion hardware produced by National Instruments led the Potter lab to develop a second open-source platform called NeuroRighter. NeuroRighter was created by John Rolston, Jon Newman, and Riley Zeller-Townson. This platform significantly reduced the cost of data acquisition for MEAs compared to MEABench from around $60,000 to $10,000. To increase usability compared to MEABench, NeuroRighter operates as a standalone application with graphical control over filter and amplifier settings, online spike-sorting, data visualization, and data storage40,41. Further, NeuroRighter integrated native support for real-time feedback. NeuroRighter's data processing pipeline can be augmented using an application programing interface (API) to create “plugin” libraries that can be executed by NeuroRighter as it operates 41. The NeuroRigher API also supports electrical and optical stimulation protocols, making closed-loop experimentation possible.

ArtE

The A/D system worked reliably in the Wilson lab for over two decades, but it was only compatible with an outdated operating system (DOS) and obsolete hardware. The increasing difficulty of obtaining replacement parts motivated a total rewrite of the underlying code for National Instruments hardware and GNU/Linux. This project was named ArtE (Almost Realtime Electrophysiology), to highlight the intention to provide closed-loop feedback. In addition to supporting an equivalent features to A/D, ArtE was designed to run in parallel with an existing A/D system, for the purpose of bootstrapping development and testing recorded spikes against a thoroughly debugged standard. The requirement to run alongside a very different system forced ArtE to be modular, with data moving between independent processes running on different machines over the network, in the spirit of MEABench.

Open Ephys

The public release of integrated amplifier chips by Intan Technologies28 made it possible to circumvent the National Instruments hardware that was a part of all the previous open-source platforms. The co-founders of the Open Ephys initiative (http://open-ephys.org), Josh Siegle and Jakob Voigts, designed a system based on these chips. The Open Ephys acquisition board featured both reduced hardware complexity and an order of magnitude drop in equipment cost compared to ArtE and NeuroRighter. Intan’s development of open interfaces (RHD2000 SPI protocol and Rhythm firmware and API) made the development process much simpler. The low price of manufacturing acquisition boards (~$700 per unit in bulk) allowed Open Ephys to distribute over 150 systems around the world in less than a year. The platform also includes software that supports customizable data processing pipelines, similarly to MEABench.

What drove the development and subsequent adoption of these open-source tools? There are a few recent factors that have allowed open-source tools to rival, and in some ways, surpass the functionality of their commercial counterparts. First of, thanks to their openness, all of the systems described above were facilitated by the advances of their predecessors. NeuroRighter was created to simplify MEABench, ArtE was inspired by the efforts of NeuroRighter, and the Open Ephys software began as a graphical interface for ArtE. Different requirements caused these systems to diverge, but there is no reason that they couldn't be made cross-compatible, or continue to benefit from the cross-pollination of ideas, or simply subserve different communities.

Advancements in open-source tools for multichannel electrophysiology reflected and benefited from technological and cultural developments occurring in parallel:

1. Smaller, cheaper, and better hardware. Market forces are pushing for ever more compact and powerful components for mobile computers. Because these components are produced in huge volumes and provide large amount of computational power, they can now fill the role of expensive application specific integrated circuits (ASICs) for multichannel data acquisition and processing.

2. Tools for collaborative design. The rise of tools such as GitHub (based on the Git version control software) lowers the barrier for collaboratively development. Additionally, wiki software allows documentation to be distributed throughout the community and continuously updated.

3. The open-source hardware movement. Products like Arduino, Raspberry Pi (http://www.raspberrypi.org/), and Beaglebone (http://beagleboard.org/) make high-powered embedded computations very accessible. Many neuroscientists are introduced to hardware design through simple prototyping platforms like the Arduino, subsequently graduating to more powerful systems. These devices set a precedent for what good open-source design should be: powerful, simple to comprehend, highly adaptable, and well-documented.

Open interfaces: a middle-of-the-road solution

Taking cues from these widely adopted open-source platforms, we propose an approach to hardware and software development for extracellular electrophysiology that centers around standardized interfaces and modular architectures. The essence of this proposal is that the most common interfaces (e.g. electrode-to-headstage, headstage-to-cable, data-to-computer) should become standardized, so that anyone can make tools that fit into the same pipeline. In Figure 2, we illustrate some of the interfaces for multichannel electrophysiology that would benefit most from standardization.

It would be inadvisable to circumvent the expertise accumulated by existing companies. In a model where systems are modular, well documented, and interoperable, companies could  concentrate their resources. Rather than developing and supporting entire systems, they could focus on making the highest quality components within a modular system. This could occur in collaboration with the scientists who require new tools, or already have their own prototypes that aren't ready for distribution. Additionally, standardization should create a market for support for existing systems, similar to how companies sell support contracts for Linux-based systems, rather than selling the software itself.

There is no fundamental reason why all the components of electrophysiology systems need to be open-source. In fact, most open tools currently make use closed-source integrated circuits. As long as the behavior of each component is well-defined, and its interfaces are documented and adhere to common standards, closed-source components are no obstacle to the functionality of the whole system. 

The same principle applies to the software used to visualize and record data. Currently,  most software is tied to commercial hardware, which leads to redundancy and lock-in. For the same reasons that we need modular hardware, modular software will become crucial in coming years. Higher channel counts demand that processing be done in real time, and many experiments would benefit from closed-loop processing. Unless there are standard interfaces for this, researchers might end up re-creating the same functionality across different platforms. Further, as more processing is done in real time, the more difficult it will be to compare the results of experiments collected on different closed platforms.

Conclusion

The gap between open-source and closed-source solutions is no longer as wide as it used to be. Open-source systems still tend to be cheaper and offer higher flexibility, while closed-source systems offer more robust hardware and professional support. But there is no fundamental reason why this distinction will hold for the future. Because the landscape of extracellular electrophysiology is changing so rapidly, we advocate for the development of standardized interfaces that will allow open-source and closed-source tools to work together. This would give scientists the option to employ home-built solutions when necessary, while relying on commercial solutions at other points in the pipeline.

The move toward open interfaces is unlikely to happen unless electrophysiologists start demanding openness wherever possible. Open interfaces could improve scientific productivity, but only if they are actively promoted and financially supported by the labs and funding agencies that stand to benefit from them.

References

1.   Hines, M. L. & Carnevale, N. T. The NEURON simulation environment. Neural computation 9, 1179-1209 (1997).
2.   Pologruto, T. A., Sabatini, B. L. & Svoboda, K. ScanImage: flexible software for operating laser scanning microscopes. Biomed Eng Online 2, 13 (2003).
3.   Delorme, A. & Makeig, S. EEGLAB: an open source toolbox for analysis of single-trial EEG dynamics including independent component analysis. J Neurosci Methods 134, 9-21 (2004).
4.   Abràmoff, M. D., Magalhães, P. J. & Ram, S. J. Image processing with ImageJ. Biophotonics international 11, 36-43 (2004).
5.   Hazan, L., Zugaro, M. & Buzsáki, G. Klusters, NeuroScope, NDManager: a free software suite for neurophysiological data processing and visualization. J Neurosci Methods 155, 207-216 (2006).
6.   Davison, A. P., Brüderle, D., Eppler, J., Kremkow, J., et al. PyNN: a common interface for neuronal network simulators. Front Neuroinformatics 2, 11 (2008).
7.   Cajigas, I., Malik, W. Q. & Brown, E. N. nSTAT: open-source neural spike train analysis toolbox for Matlab. J Neurosci Methods 211, 245-264 (2012).
8.   Englitz, B., David, S. V., Sorenson, M. D. & Shamma, S. A. MANTA—an open-source, high density electrophysiology recording suite for MATLAB. Frontiers in Neural Circuits 7,  (2013).
9.   Campagnola, L., Kratz, M. B. & Manis, P. B. ACQ4: an open-source software platform for data acquisition and analysis in neurophysiology research. Front Neuroinform 8, 3 (2014).
10.   Voigts, J., Siegle, J. H., Pritchett, D. L. & Moore, C. I. The flexDrive: An ultra-light implant for optical control and highly parallel chronic recording of neuronal ensembles in freely moving mice. Front Sys Neurosci 7,  (2013).
11.   Buzsáki, G. Large-scale recording of neuronal ensembles. Nat Neurosci 7, 446-451 (2004).
12.   Stevenson, I. H. & Kording, K. P. How advances in neural recording affect data analysis. Nat Neurosci 14, 139-142 (2011).
13.   Kandel, E. The new science of mind and the future of knowledge. Neuron 80, 546-560 (2013).
14.   Marblestone, A. H., Zamft, B. M., Maguire, Y. G., Shapiro, M. G., et al. Physical principles for scalable neural recording. Front Comput Neurosci 7, 137 (2013).
15.   Zhang, F., Wang, L. P., Boyden, E. S. & Deisseroth, K. Channelrhodopsin-2 and optical control of excitable cells. Nat Methods 3, 785-792 (2006).
16.   Yizhar, O., Fenno, L. E., Davidson, T. J., Mogri, M. & Deisseroth, K. Optogenetics in neural systems. Neuron 71, 9-34 (2011).
17.   Zorzos, A. N., Boyden, E. S. & Fonstad, C. G. A multi-waveguide implantable probe for light delivery to sets of distributed brain targets. Opt Lett 35, 4133-4135 (2010).
18.   Wentz, C. T., Bernstein, J. G., Monahan, P., Guerra, A., et al. A wirelessly powered and controlled device for optical neural control of freely-behaving animals. J Neural Eng 8, 046021 (2011).
19.   Packer, A. M., Roska, B. & Häusser, M. Targeting neurons and photons for optogenetics. Nat Neurosci 16, 805-815 (2013).
20.   Reutsky-Gefen, I., Golan, L., Farah, N., Schejter, A., et al. Holographic optogenetic stimulation of patterned neuronal activity for vision restoration. Nat Commun 4, 1509 (2013).
21.   Siegle, J. H. & Wilson, M. A. Enhancement of encoding and retrieval functions through theta phase-specific manipulation of hippocampus. eLife 3, e03061 (2014).
22.   Anikeeva, P., Andalman, A. S., Witten, I., Warden, M., et al. Optetrode: a multichannel readout for optogenetic control in freely moving mice. Nat Neurosci 15, 163-170 (2011).
23.   Blanche, T. J., Spacek, M. A., Hetke, J. F. & Swindale, N. V. Polytrodes: high-density silicon electrode arrays for large-scale multiunit recording. J Neurophysiol 93, 2987-3000 (2005).
24.   Du, J., Blanche, T. J., Harrison, R. R., Lester, H. A. & Masmanidis, S. C. Multiplexed, high density electrophysiology with nanofabricated neural probes. PLoS One 6, e26204 (2011).
25.   Stark, E., Koos, T. & Buzsáki, G. Diode probes for spatiotemporal optical control of multiple neurons in freely moving animals. J Neurophysiol 108, 349-363 (2012).
26.   Lopez, C. M., Andrei, A., Mitra, S., Welkenhuysen, M., et al. An implantable 455-active-electrode 52-channel CMOS neural probe. Solid-State Circuits Conference Digest of Technical Papers (ISSCC), 2013 IEEE International 288-289 (2013).
27.   Harrison, R. R., Watkins, P. T., Kier, R. J., Lovejoy, R. O., et al. A low-power integrated circuit for a wireless 100-electrode neural recording system. Solid-State Circuits, IEEE Journal of 42, 123-133 (2006).
28.   Harrison, R. R. A versatile integrated circuit for the acquisition of biopotentials. Custom Integrated Circuits Conference, 2007. CICC'07. IEEE 115-122 (2008).
29.   Fee, M. S., Mitra, P. P. & Kleinfeld, D. Automatic sorting of multiple unit neuronal signals in the presence of anisotropic and non-Gaussian variability. J Neurosci Methods 69, 175-188 (1996).
30.   Wild, J., Prekopcsak, Z., Sieger, T., Novak, D. & Jech, R. Performance comparison of extracellular spike sorting algorithms for single-channel recordings. J Neurosci Methods 203, 369-376 (2012).
31.   Nguyen, T. K., Navratilova, Z., Cabral, H., Wang, L., et al. Closed-loop optical neural stimulation based on a 32-channel low-noise recording system with online spike sorting. J Neural Eng 11, 046005 (2014).
32.   Schmitzer-Torbert, N., Jackson, J., Henze, D., Harris, K. & Redish, A. D. Quantitative measures of cluster quality for use in extracellular recordings. Neuroscience 131, 1-11 (2005).
33.   Cohen, M. R. & Maunsell, J. H. Using neuronal populations to study the mechanisms underlying spatial and feature attention. Neuron 70, 1192-1204 (2011).
34.   Gray, C. M., Maldonado, P. E., Wilson, M. & McNaughton, B. Tetrodes markedly improve the reliability and yield of multiple single-unit isolation from multi-unit recordings in cat striate cortex. J Neurosci Methods 63, 43-54 (1995).
35.   Nguyen, D. P., Layton, S. P., Hale, G., Gomperts, S. N., et al. Micro-drive array for chronic in vivo recording: tetrode assembly. J Vis Exp  (2009).
36.   Wilson, M. A. & McNaughton, B. L. Dynamics of the hippocampal ensemble code for space. Science 261, 1055-1058 (1993).
37.   Wilson, M. A. & McNaughton, B. L. Reactivation of hippocampal ensemble memories during sleep. Science 265, 676-679 (1994).
38.   Wagenaar, D. A. & Potter, S. M. Real-time multi-channel stimulus artifact suppression by local curve fitting. Journal of neuroscience methods 120, 113-120 (2002).
39.   Wagenaar, D., DeMarse, T. B. & Potter, S. M. MEABench: A toolset for multi-electrode data acquisition and on-line analysis. Neural Engineering, 2005. Conference Proceedings. 2nd International IEEE EMBS Conference on 518-521 (2005).
40.   Rolston, J. D., Gross, R. E. & Potter, S. M. A low-cost multielectrode system for data acquisition enabling real-time closed-loop processing with rapid recovery from stimulation artifacts. Front Neuroengineering 2, 12 (2009).
41.   Newman, J. P., Zeller-Townson, R., Fong, M. F., Arcot Desai, S., et al. Closed-loop, multichannel experimentation using the open-source NeuroRighter electrophysiology platform. Front Neural Circuits 6, 98 (2012).



Figure 1 | Contextual time-course of open-source multichannel electrophysiology systems. The improvements in usability, flexibility, and computational power of open-source multichannel data acquisition systems for electrophysiology have paralleled growth in open-source culture (e.g. the introduction of Arduino, Git, and You-tube in 2005) and technological developments within neuroscience (e.g. the introduction of Intan Technologies integrated bioamplifiers in 2009). In the last 20 years, the cost per acquisition channel has decreased by nearly 2 orders while available channel counts have increased by an order of magnitude.



Figure 2 | Key interfaces within multichannel electrophysiology platforms. From the level of electrodes (left) to analysis software (right), more effort could be devoted to standardizing the interfaces between the various components. In this figure, the most important interfaces for large-scale electrophysiology are highlighted in blue; between them are examples of some of the wide array of options for the individual components.
