Neural ensemble communities: Open-source approaches to hardware for large-scale recordingJoshua H. Siegle1,2, Gregory J Hale2, Jonathan P. Newman2, Jakob Voigts21Present address: Allen Institute for Brain Science, Seattle, WA2Department of Brain and Cognitive Sciences, MIT, Cambridge, MA# AbstractOne often overlooked factor when selecting tools for recording from many extracellular electrodes simultaneously is whether or not a system is open or closed: that is, whether or not the schematics and source code are accessible to the end users. Open systems have a reputation for being difficult to acquire, poorly documented, and hard to maintain. However, with the rise of more powerful integrated circuits, rapid prototyping services, and web-based tools for collaborative development, these stereotypes no longer apply. We discuss some of the reasons why large-scale electrophysiology could benefit from open-source approaches and describe examples of successful community-driven tool development in the field. Rather than championing the use of open-source hardware and software in all instances, we advocate a move toward standardized open interfaces that connect each element of the data processing pipeline. This will give researchers the flexibility to modify their tools when necessary, while allowing them to benefit from the high-quality products and expertise provided by commercial vendors.# IntroductionNew discoveries in neuroscience closely follow the introduction of new tools. Our community has a tradition of inventing new methods in order to fulfill the requirements of technically demanding experiments. When new tools or techniques are required, scientists must either invest the resources to build them or outsource these efforts to companies that sell finished devices. Commercial products have traditionally been the best option, offering more reliability, features, and technical support than individual labs could provide. However, this commercial stability comes at the cost of proprietary hardware designs and source code, preventing modification by users and commercial competitors. In some instances, this can hinder progress. When commercial tools are treated as "black box" commodities that cannot modified, it may limit scientists’ understanding of the resulting data as well as their ability to add new functionality to existing equipment. Furthermore, tools from different companies—even those designed for the same function—are often incompatible with one another. Once a system is chosen, future work may end up locked in to a particular data processing pipeline.In some labs custom tools are routinely developed to circumvent these limitations, but often with little thought to standardization. Recent changes in the landscape of open-source design have increased the quality and standardization of in-house tools, extending their usefulness to other labs. When designed properly, open-source tools can combine the usability and support of commercial products with the high performance and adaptability tools developed in-house. In this opinion piece, we will outline the merits of open-source development schemes. We argue that the vanishing differences in product quality between open and closed solutions for high-channel-count electrophysiology no longer justify the increased cost, hardware lock-in, and lack of interoperability of commercial options. We contend that open-source tool development in electrophysiology will offer considerable productivity benefits for scientists (even those without an inclination toward engineering) as the culture of collaborative development reduces our reliance on closed-source systems.# Electrophysiology is well-suited for an open development modelIn the simplest case, recording electrical signals from the brain only requires two conductors to measure a potential difference, a means of amplifying that difference, and a method to store changes in this signal over time. A century ago, nerve impulses were being amplified using vacuum tubes and recorded on photographic film scanned behind a mercury column{Adrian 1926}. Today, mass-produced circuits costing a few dollars can be used to amplify neural signals and store them digitally. In recent years, there has been a push to record from many channels simultaneously in order to understand the brain at the network level{Buzsáki 2004; Stevenson 2011; Kandel 2013}. Simultaneously, experimental designs now call for equipment that can manipulate neural activity, as well as record it.For the most part, these advances in recording and stimulation technology have occurred within individual labs and were then commercialized and distributed. The resulting systems are typically monolithic and closed. Some of the major vendors of commercial data acquisition systems are Neuralynx, Plexon, Blackrock, Tucker-Davis Technologies, Ripple, and Axona. By giving researchers access to high-quality, professionally tested tools, as well as reliable support services, these companies have been essential to the proliferation of multichannel electrophysiology systems over the past two decades. However, it is no longer clear that these services should be provided exclusively by commercial entities.We see three reasons why the current model of tool development and distribution would benefit from an active open-source community:1. Electrode technology is advancing rapidly. Experimenters using twisted-wire tetrodes are packing more electrodes into a smaller area{Voigts 2013}, silicon probes are becoming thinner and denser{Blanche 2005; Du 2011}, and active probes are under development{Lopez 2013}. Researchers need the flexibility to choose among these options, or to mix technologies. Companies that implement proprietary standards often prevent this. One recent example of this is the development of amplifier chips by Intan technologies, which can amplify and digitize up to 64 channels of neural data in an 8 x 8 mm package (http://www.intantech.com). When integrated into a "headstage" (the interface that connects electrodes to a data acquisition system), Intan chips offer considerable advantages over analog systems. For this reason, nearly every major vendor now sells headstages that use Intan chips, but none of them are interchangeable. Users are stuck with whatever connectors the vendors have chosen to provide, and cannot customize them without the help of the manufacturer.2. On the software side, the requirements for analysis and visualization vary greatly between labs, and even between experiments. Specialized algorithms are needed to handle electrophysiological data, especially when closed-loop feedback is required. It's often impossible to predict which algorithms will work best before the experiments have been run. An example of this is online spike-sorting, which allows researchers to analyze the activity of single neurons. A few commercial systems already implement this method, but use different algorithms that may not be fully disclosed. This makes it difficult or impossible to compare data collected across different labs{Cohen 2011}.3. Electrophysiologists tend to be technically savvy and favor a "do it yourself" approach to science. Some of this is cultural, but much of it is out of necessity. The complexity of neurological systems has forced many electrophysiologists to develop customized hardware and software for their experiments. Unfortunately, very little of this development is currently shared, leading to a huge amount of redundant effort within and across laboratories.These reasons, which are not unique to extracellular electrophysiology, make it likely that a shift toward a more open development model will occur in the near future.A brief history of open-source approaches to multichannel data acquisitionSince the widespread adoption of multichannel recording techniques, there have been several attempts to develop open-source recording platforms that are polished enough and sufficiently well-documented to propagate beyond the labs that invented them. This is not meant to be an exhaustive list of such platforms, but rather to provide examples of how shifts in technology created opportunities for scientists to improve on previously available systems. Figure 1 charts the changes that have occurred in the price and channel count of these systems over time.A/DOne of the first advances that drove the need for high-channel-count extracellular electrophysiology was the introduction of tetrode recording technology{Gray 1995}. By placing four tightly spaced electrodes at a single location in the brain, tetrodes increased the number of identified neurons that could be isolated. Tetrodes were essential for understanding of how the hippocampus represents the environment {Wilson 1993; Wilson 1994}, but also required four times as many channels. In Bruce McNaughton’s lab at the University of Arizona, and later in his own lab at MIT, Matt Wilson and Loren Frank designed and built the “A/D,” an open-source system capable of processing data from many tetrodes in parallel. The closed-source alternative, DataWave, lacked the flexibility required for tetrode recordings, and Dr. Wilson didn’t want his research to be tied to the destiny of a single company. Although the designs for A/D were open, they were shared by invitation only, since there was no way to monitor the easily monitor the quality of modifications to the source code.MEABenchAnother domain requiring high channel counts is recording of action potentials from cell cultures. In 2005, Daniel Wagenaar, Tom Demarse, and Steve Potter created MEABench, a set of Linux (https://www.kernel.org/) command-line programs for acquiring, processing, and saving voltages from planar microelectrode arrays (MEAs). Each MEABench program applies a function, such as “Filter” or “Record,” to a multichannel data stream. A standardized interface allows programs to be daisy-chained and branched in order to construct complex signal processing arrangements. Although MEABench does not provide native support for closed-loop experiments, it can combined with real-time simulation tools{Wagenaar 2002} to create feedback loops{Wagenaar 2005}. MEABench has limited hardware driver support and currently only works with outdated and very expensive Multichannel Systems (Reutlingen, Germany) data acquisition cards. However, the modularity and reconfigurability of MEABench have inspired more modern, extensible, easy-to-use open-source solutions.NeuroRighterIn the mid-2000s, the introduction of high-channel-count analog-to-digital conversion hardware produced by National Instruments led the Potter lab to develop a second open-source platform called NeuroRighter. NeuroRighter was created by John Rolston, Jon Newman, and Riley Zeller-Townson. NeuroRighter significantly reduced the cost of data acquisition for MEAs compared to MEABench from around $60,000 to $10,000. To increase usability compared to MEABench, NeuroRighter operates as a standalone application with graphical control over filter and amplifier settings, online spike-sorting, data visualization, and data storage{Rolston 2009; Newman 2012}. Further, NeuroRighter integrated native support for real-time feedback. NeuroRighter's data processing pipeline can be augmented using an application programing interface (API) to create “plugin” libraries that can be executed by NeuroRighter as it operates {Newman 2012}. The NeuroRigher API also supports electrical and optical stimulation protocols, so that closed-loop experimentation is possible.ArtEThe A/D system worked reliably for nearly two decades, but was only compatible with an outdated operating system (DOS) and obsolete hardware. The increasing difficulty of obtaining replacement parts motivated a total rewrite of the underlying code for National Instruments hardware and GNU/Linux. This project was named ArtE (Almost Realtime Electrophysiology), to highlight the intention to provide closed-loop feedback. In addition to supporting an equivalent features to A/D, ArtE was designed to run in parallel with an existing A/D system, for the purpose of bootstrapping development and testing recorded spikes against a thoroughly debugged standard. The requirement to run alongside a very different system forced ArtE to be modular, with data moving between independent processes running on different machines over the network, in the spirit of MEABench.Open EphysThe public release of integrated amplifier chips by Intan Technologies{Harrison 2008} made it possible to circumvent the National Instruments hardware that was a part of all the previous open-source platforms. The co-founders of the Open Ephys initiative, Josh Siegle and Jakob Voigts, designed a system based on these chips with reduced hardware complexity and an order of magnitude drop in equipment cost compared to ArtE and NeuroRighter. The support of open interfaces by Intan (RHD2000 SPI protocol and Rhythm firmware and API) made the process simpler and made the tools compatible with hardware and software from Intan. The low price of manufacturing acquisition boards (~$700 per unit in bulk) allowed Open Ephys to widely distribute the tools. The platform also includes software that allowed the user to easily customize the data processing pipeline, similarly to MEABench.What drove the development and subsequent adoption of these open-source tools? There are a few recent factors that have allowed open-source tools to rival, and in some ways, surpass the functionality of their commercial counterparts. First of, thanks to their openness, all of the systems described above were facilitated by the advances of their predecessors. NeuroRighter was created to simplify MEABench, ArtE was inspired by the efforts of NeuroRighter, and the Open Ephys software began as a graphical interface for ArtE. Different requirements caused these systems to diverge, but there is no reason that they couldn't be made cross-compatible, or continue to benefit from the cross-pollination of ideas, or simply subserve different communities.Advancements in open-source tools for multichannel electrophysiology reflected and benefited from a parallel technological and cultural developments:1. Smaller, cheaper, and better hardware. Market forces are pushing for ever more compact and powerful components  for mobile computers. Because these components are produced in huge volumes and provide large amount of computational power, they can now fill the role of extremely expensive application specific integrated circuits (ASICs) for multichannel data acquisition and processing.2. Tools for collaborative design. The rise of tools such as GitHub (based on the Git version control software) lowers the barrier for collaboratively development. Additionally, wiki software allow the distributed and constantly updated documentation of these tools.3. The open-source hardware movement. Products like Arduino, Raspberry Pi (http://www.raspberrypi.org/), and Beaglebone (http://beagleboard.org/) make high-powered embedded computations very accessible. Many neuroscientists are introduced to hardware design through simple prototyping platforms like the Arduino, and then graduate to more powerful systems. These devices set a precedent for what good open-source design should be: powerful, simple to comprehend, highly adaptable, and well-documented.Open interfaces: a middle-of-the-road solutionTaking cues from these widely adopted open-source platforms, we propose an open approach to hardware and software development for extracellular electrophysiology that centers around standardized interfaces and modular architectures. The essence of this proposal is that the most common interfaces (e.g. electrode-to-headstage, headstage-to-cable, data-to-computer) should become standardized, so that anyone can make tools that fit into the same pipeline. In Figure 2, we illustrate some of the interfaces for multichannel electrophysiology that would benefit most from standardization.There is no reason for this to circumvent the expertise accumulated by existing companies. In a model where systems are modular, well documented, and interoperable, companies could  concentrate their resources. Rather than developing and supporting entire systems, they could focus on making the highest quality components within a modular system. This could occur in collaboration with the scientists who require new tools, or already have their own prototypes that aren't ready for distribution. Additionally, standardization should create a market for support for existing systems, similar to how companies sell support contracts for Linux-based systems, rather than selling the software itself.There is no fundamental reason why all components of electrophysiology systems need to be open-source. Most open tools currently make use closed-source integrated circuits. As long as the behavior of each component is well-defined, and its interfaces are documented and adhere to common standards, closed-source components are no obstacle to the functionality of the whole system. The same principle applies to the software used to visualize and record data. Currently,  most software is tied to commercial hardware, which leads to redundancy and lock-in. For the same reasons that we need modular hardware, modular software will become crucial in coming years. Higher channel counts demand that processing be done in real time, and many experiments would benefit from closed-loop processing. Unless there are standard interfaces for this, researchers might end up re-creating the same functionality across different platforms. Further, as more processing is done in real time, the more difficult it will be to compare the results of experiments collected on different closed platforms.ConclusionThe gap between open-source and closed-source solutions is no longer as wide as it used to be. Open-source systems stilltend to be cheaper and offer higher flexibility, while closed-source systems offer more robust hardware professional support, but there is no fundamental reason why this distinction will hold for the future. Because the landscape of extracellular electrophysiology is changing so rapidly, we advocate for the development of standardized interfaces that will allow open-source and closed-source tools to work together. This would give scientists the option to employ home-built solutions when necessary, while relying on commercial solutions at other points in the pipeline.The move toward open interfaces is unlikely to happen unless electrophysiologists start demanding openness wherever possible. Open interfaces could improve scientific productivity, but only if they are actively promoted and financially supported by the labs and funding agencies that stand to benefit from them.References{bibliography}Figure 1 | Contextual time-course of open-source multichannel electrophysiolgy systems. The improvements in usability, flexibility, and computational power of open-source multichannel data acquisition systems for electrophysiology have paralleled growth in open-source culture (e.g. the introduction of Arduino, Git, and You-tube in 2005) and technological developments within neuroscience (e.g. the introduction of Intan Technologies integrated bioamplifiers in 2009). In the last 20 years, the cost per acquisition channel has decreased by nearly 2 orders while available channel counts have increased by an order of magnitude.Figure 2 | Title. Caption.